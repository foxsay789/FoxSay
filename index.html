
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <title>维斯特洛江浙沪地图 - 权力游戏版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap');
        body, html {
            font-family: 'MedievalSharp', cursive;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        .float {
            animation: float 3s ease-in-out infinite;
        }
        .got-bg {
            background: linear-gradient(135deg, #2C3E50, #34495E, #2C3E50);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .parchment {
            background-color: #F4E6CC;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            border: 2px solid #8B4513;
        }
    </style>
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=2.0&key=48a04284f106bb75500387301fa56eda"></script>
</head>
<body class="bg-gray-900 text-gray-200">
    <div id="container" class="w-full h-screen"></div>
    <div id="stylePanel" class="absolute top-4 left-4 z-50 got-bg text-gray-300 rounded-lg shadow-lg p-4 w-64 fade-in text-sm">
        <h2 class="text-lg font-bold mb-4 text-yellow-500">王国风格</h2>
        <select id="mapStyleSelect" class="w-full p-2 mb-2 border border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 bg-gray-800 text-gray-300">
            <option value="amap://styles/normal">维斯特洛</option>
            <option value="amap://styles/dark" selected>长夜</option>
            <option value="amap://styles/light">白昼</option>
            <option value="amap://styles/whitesmoke">凛冬</option>
            <option value="amap://styles/fresh">河间地</option>
            <option value="amap://styles/grey">铁群岛</option>
            <option value="amap://styles/blue">河湾地</option>
            <option value="amap://styles/wine">多恩</option>
        </select>
    </div>
    <div id="markerPanel" class="absolute top-4 right-4 z-50 got-bg text-gray-300 rounded-lg shadow-lg p-4 w-64 fade-in text-sm">
        <h2 class="text-lg font-bold mb-4 text-yellow-500">添加标记</h2>
        <select id="markerTypeSelect" class="w-full p-2 mb-4 border border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 bg-gray-800 text-gray-300">
            <option value="castle">🏰 临冬城</option>
            <option value="crystal">💎 龙晶</option>
            <option value="potion">🧪 野火</option>
            <option value="wand">🗡️ 瓦雷利亚钢剑</option>
            <option value="dragon">🐉 巨龙</option>
        </select>
        <button id="addMarker" class="w-full bg-yellow-600 hover:bg-yellow-700 text-gray-900 font-bold py-2 px-4 rounded-md transition duration-300 ease-in-out mb-2">
            放置标记
        </button>
        <button id="clearMarkers" class="w-full bg-red-700 hover:bg-red-800 text-gray-200 font-bold py-2 px-4 rounded-md transition duration-300 ease-in-out">
            清除标记
        </button>
    </div>
    <script>
        var map = new AMap.Map('container', {
            zoom: 7,
            center: [120.5, 30.5],
            viewMode: '3D',
            mapStyle: 'amap://styles/dark'
        });

        var districtCodes = ['310000', '320000', '330000'];
        var districtPolygons = [];

        function updateDistrictColors() {
            var strokeColor, fillColor;
            switch(map.getMapStyle()) {
                case 'amap://styles/dark':
                    strokeColor = '#FFD700';
                    fillColor = '#B8860B';
                    break;
                case 'amap://styles/light':
                    strokeColor = '#8B4513';
                    fillColor = '#DEB887';
                    break;
                case 'amap://styles/whitesmoke':
                    strokeColor = '#4682B4';
                    fillColor = '#B0C4DE';
                    break;
                case 'amap://styles/fresh':
                    strokeColor = '#228B22';
                    fillColor = '#32CD32';
                    break;
                case 'amap://styles/grey':
                    strokeColor = '#2F4F4F';
                    fillColor = '#708090';
                    break;
                case 'amap://styles/blue':
                    strokeColor = '#00008B';
                    fillColor = '#4169E1';
                    break;
                case 'amap://styles/wine':
                    strokeColor = '#8B0000';
                    fillColor = '#DC143C';
                    break;
                default:
                    strokeColor = '#CD853F';
                    fillColor = '#DEB887';
            }
            districtPolygons.forEach(polygon => {
                polygon.setOptions({
                    strokeColor: strokeColor,
                    fillColor: fillColor
                });
            });
        }

        AMap.plugin('AMap.DistrictSearch', function() {
            var districtSearch = new AMap.DistrictSearch({
                level: 'province',
                subdistrict: 0
            });

            districtCodes.forEach(function(code) {
                districtSearch.search(code, function(status, result) {
                    if (status === 'complete') {
                        var bounds = result.districtList[0].boundaries;
                        var polygon = new AMap.Polygon({
                            path: bounds,
                            strokeColor: '#CD853F',
                            strokeWeight: 2,
                            strokeOpacity: 0.8,
                            fillOpacity: 0.2,
                            fillColor: '#DEB887',
                            zIndex: 50,
                        });
                        map.add(polygon);
                        districtPolygons.push(polygon);
                    }
                });
            });
        });

        AMap.plugin('AMap.Scale', function() {
            var scale = new AMap.Scale();
            map.addControl(scale);
        });

        var markers = [];
        var addMarkerMode = false;

        var markerEmojis = {
            castle: '🏰',
            crystal: '💎',
            potion: '🧪',
            wand: '🗡️',
            dragon: '🐉'
        };

        var markerDescriptions = {
            castle: "临冬城，史塔克家族的祖传城堡，坐落于北境的中心。这座巍峨的要塞由两道城墙和一道护城河环绕，是抵御凛冬和异鬼的最后防线。城内有着温泉水系统，即使在最寒冷的冬天也能保持温暖。",
            crystal: "龙晶，又称龙石，是维斯特洛大陆上最珍贵的矿物之一。它不仅能够杀死异鬼，还可以用来制作瓦雷利亚钢。传说中，龙晶是远古巨龙的化石，蕴含着强大的魔力。",
            potion: "野火，由炼金术士调制的高度易燃液体，燃烧时呈现出诡异的绿色火焰。它能在水上燃烧，威力巨大，曾在黑水河之战中发挥关键作用。然而，它的不稳定性也使得使用时充满危险。",
            wand: "瓦雷利亚钢剑，由失落的瓦雷利亚文明锻造而成。这种剑不仅锋利无比，永不卷刃，还异常轻盈。每把瓦雷利亚钢剑都是无价之宝，往往世代相传，成为贵族家族的象征。",
            dragon: "巨龙，传说中的生物，曾经统治着整个世界的天空。它们能够喷吐烈焰，鳞甲坚不可摧。坦格利安家族凭借驾驭巨龙的能力统一了七大王国。如今，丹妮莉丝·坦格利安重新孵化了三条幼龙，预示着龙之时代的回归。"
        };

        document.getElementById('mapStyleSelect').onchange = function() {
            map.setMapStyle(this.value);
            updateDistrictColors();
        };

        document.getElementById('addMarker').onclick = function() {
            addMarkerMode = !addMarkerMode;
            this.innerHTML = addMarkerMode ? '点击地图放置' : '放置标记';
            this.classList.toggle('bg-yellow-600');
            this.classList.toggle('bg-green-600');
        };

        document.getElementById('clearMarkers').onclick = function() {
            markers.forEach(marker => marker.remove());
            markers = [];
        };

        map.on('click', function(e) {
            if (addMarkerMode) {
                var markerType = document.getElementById('markerTypeSelect').value;
                var marker = new AMap.Marker({
                    position: e.lnglat,
                    content: `<div class="float" style="font-size: 30px;">${markerEmojis[markerType]}</div>`,
                    offset: new AMap.Pixel(-15, -15)
                });

                marker.setMap(map);
                markers.push(marker);

                var infoWindow = new AMap.InfoWindow({
                    content: `<div class="p-2 parchment text-gray-800 rounded-lg">
                        <p class="font-bold text-xl mb-2">${document.getElementById('markerTypeSelect').options[document.getElementById('markerTypeSelect').selectedIndex].text}</p>
                        <p class="text-sm mb-2">坐标：${e.lnglat.toString()}</p>
                        <p class="text-sm">${markerDescriptions[markerType]}</p>
                    </div>`,
                    offset: new AMap.Pixel(0, -30)
                });

                marker.on('click', function() {
                    infoWindow.open(map, marker.getPosition());
                });

                addMarkerMode = false;
                document.getElementById('addMarker').innerHTML = '放置标记';
                document.getElementById('addMarker').classList.remove('bg-green-600');
                document.getElementById('addMarker').classList.add('bg-yellow-600');
            }
        });
    </script>
</body>
</html>
